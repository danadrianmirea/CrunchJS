var f,h=this;
function l(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function aa(a){var b=l(a);return"array"==b||"object"==b&&"number"==typeof a.length}function m(a){return"string"==typeof a}function p(a){return"function"==l(a)}var q="closure_uid_"+(1E9*Math.random()>>>0),ba=0;function ca(a,b,c){return a.call.apply(a.bind,arguments)}
function da(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function r(a,b,c){r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ca:da;return r.apply(null,arguments)}var u=Date.now||function(){return+new Date};
function v(a,b){function c(){}c.prototype=b.prototype;a.u=b.prototype;a.prototype=new c;a.Xa=function(a,c,g){var k=Array.prototype.slice.call(arguments,2);return b.prototype[c].apply(a,k)}};function ea(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function fa(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function ga(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var ha="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ia(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var g=0;g<ha.length;g++)c=ha[g],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var w=Array.prototype,ja=w.indexOf?function(a,b,c){return w.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(m(a))return m(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},x=w.forEach?function(a,b,c){w.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(""):a,g=0;g<d;g++)g in e&&b.call(c,e[g],g,a)};
function ka(a,b){var c;a:{c=a.length;for(var d=m(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){c=e;break a}c=-1}return 0>c?null:m(a)?a.charAt(c):a[c]}function la(a,b){var c=ja(a,b),d;(d=0<=c)&&w.splice.call(a,c,1);return d}function ma(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};function y(a,b){this.b={};this.c=[];this.o=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.X(a)}f=y.prototype;f.q=function(){na(this);for(var a=[],b=0;b<this.c.length;b++)a.push(this.b[this.c[b]]);return a};f.ca=function(){na(this);return this.c.concat()};f.clear=function(){this.b={};this.o=this.c.length=0};
f.remove=function(a){return z(this.b,a)?(delete this.b[a],this.o--,this.c.length>2*this.o&&na(this),!0):!1};function na(a){if(a.o!=a.c.length){for(var b=0,c=0;b<a.c.length;){var d=a.c[b];z(a.b,d)&&(a.c[c++]=d);b++}a.c.length=c}if(a.o!=a.c.length){for(var e={},c=b=0;b<a.c.length;)d=a.c[b],z(e,d)||(a.c[c++]=d,e[d]=1),b++;a.c.length=c}}f.get=function(a,b){return z(this.b,a)?this.b[a]:b};f.set=function(a,b){z(this.b,a)||(this.o++,this.c.push(a));this.b[a]=b};
f.X=function(a){var b;a instanceof y?(b=a.ca(),a=a.q()):(b=ga(a),a=fa(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};function z(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var A;function oa(){}oa.prototype.j=function(){};oa.prototype.sa=function(){};function pa(a){if("function"==typeof a.q)return a.q();if(m(a))return a.split("");if(aa(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return fa(a)}
function qa(a,b){if("function"==typeof a.forEach)a.forEach(b,void 0);else if(aa(a)||m(a))x(a,b,void 0);else{var c;if("function"==typeof a.ca)c=a.ca();else if("function"!=typeof a.q)if(aa(a)||m(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=ga(a);else c=void 0;for(var d=pa(a),e=d.length,g=0;g<e;g++)b.call(void 0,d[g],c&&c[g],a)}};function B(a){this.b=new y;a&&this.X(a)}function ra(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+(a[q]||(a[q]=++ba)):b.substr(0,1)+a}f=B.prototype;f.add=function(a){this.b.set(ra(a),a)};f.X=function(a){a=pa(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};f.remove=function(a){return this.b.remove(ra(a))};f.clear=function(){this.b.clear()};f.q=function(){return this.b.q()};function C(a){this.ia=null;this.ia=null!=a?a:h;a=r(this.Ma,this);this.ia.onmessage=a}v(C,oa);C.prototype.Ma=function(a){null!=a.data&&null!=a.data.eventName&&this.sa(a.data.eventName,a.data.data)};C.prototype.j=function(a,b){this.ia.postMessage({eventName:a,data:b})};function D(){this.w=new y;this.wa=new B;this.S=null}D.prototype.fireEvent=function(a,b){var c=this.w.get(a),d=!1;null!=a&&(null!=c&&qa(c,function(a){p(a)&&(d=!0,a(b))}),!d&&null!=this.S&&this.S(a,b),qa(this.wa,function(c){p(c)&&c(a,b)}))};D.prototype.addEventListener=function(a,b){var c;z(this.w.b,a)?c=this.w.get(a):(c=new B,this.w.set(a,c));c.add(b)};D.prototype.removeEventListener=function(a,b){return this.w.get(a).remove(b)};function E(a){D.call(this);this.R=a;this.va={};this.va.Wa="remote_engine_ready";this.R.sa=r(this.fireEvent,this);this.j=r(this.R.j,this.R)}v(E,D);E.prototype.j=function(){};function F(a){E.call(this,a);this.addEventListener(G,r(this.Pa,this));this.addEventListener(H,r(this.Na,this));this.addEventListener(sa,r(this.Sa,this));this.addEventListener(ta,r(this.Ra,this));this.addEventListener(ua,r(this.Ua,this));this.S=r(this.Ba,this)}v(F,E);f=F.prototype;f.P=function(){this.j(G)};f.pause=function(){this.j(H)};f.write=function(a){this.j(ua,a)};f.Pa=function(){A.A||A.P()};f.Na=function(){A.A&&A.pause()};f.Ba=function(a,b){A.fireEvent(a,b)};f.Sa=function(){};f.Ra=function(){};
f.Ua=function(a){A.write(a)};function va(a){this.xa=new Worker(a);F.call(this,new C(this.xa))}v(va,F);function I(a){this.B=a}I.prototype.a=function(){return this.B};I.prototype.d=function(){};I.prototype.h=function(){};function J(a){this.B=a;this.m=1;this.H=new B;this.U=new B;this.V=[];this.entities=0}v(J,I);f=J.prototype;f.d=function(){J.u.d.call(this);this.a().addEventListener(wa,r(this.Ia,this));this.a().addEventListener(xa,r(this.Ja,this));this.a().addEventListener(za,r(this.La,this));this.a().addEventListener(Aa,r(this.Ka,this))};f.Ia=function(a){A.log("Create Entity:"+a);Ba(this,a)};
f.Ja=function(a){A.log("Destroy Entity:"+a);this.V.push(a);this.entities--;this.H.remove(a)||this.U.remove(a);this.a().fireEvent(Ca,a)};f.La=function(a){A.log("Entity Enabled:"+a);this.U.remove(a);this.H.add(a);this.a().fireEvent(Da,a)};f.Ka=function(a){A.log("Entity Disabled:"+a);this.H.remove(a);this.U.add(a);this.a().fireEvent(Ea,a)};
function Ba(a,b){if(a.m>b)null==ka(a.V,function(a){return a==b})?A.log("Entity Id collision for sync. Id: "+b):(la(b),Fa(a,b));else{if(a.m<b)for(;a.m<b;)a.V.push(a.m),a.m++;Fa(a,b);a.m++}}function Fa(a,b){a.H.add(b);a.entities++;a.a().fireEvent(Ga,b)};function K(a){this.B=a;this.ga=[]}v(K,I);K.prototype.d=function(){K.u.d.call(this);x(this.ga,function(a){var b=this.a();a.B=b;a.d()})};K.prototype.h=function(){x(this.ga,function(a){a.h()})};K.prototype.r=function(a){x(this.ga,function(b){b.r(a)})};function L(){this.za=32;this.C=5}L.Ga=function(){return L.qa?L.qa:L.qa=new L};f=L.prototype;f.set=function(a,b){return a[b-1>>this.C]|=1<<b-1};f.clear=function(a,b){return a[b-1>>this.C]&=255^1<<b-1};f.get=function(a,b){return 0!==(a[b-1>>this.C]&1<<b-1)};f.length=function(a){return 0===Ha(a)?0:this.za*(Ha(a)-1)+(a[Ha(a)-1].toString(2).length+1)};function Ha(a){var b,c,d;b=a.length;for(c=d=a.length-1;(0>=d?0>=c:0<=c)&&0===a[c];0>=d?c++:c--)b--;return b}
f.toString=function(a){var b,c,d;c=[];b=0;for(d=this.length();0<=d?b<=d:b>=d;0<=d?b++:b--)this.get(a,b)&&c.push(b);return"{"+c.join(",")+"}"};function M(a){this.B=a;this.f=new y;this.l=[];this.I=[];this.D=L.Ga();this.T=new B}v(M,I);f=M.prototype;f.d=function(){M.u.d.call(this);this.a().addEventListener(Ga,r(this.Da,this));this.a().addEventListener(Ca,r(this.Ea,this));this.a().addEventListener(Ia,r(this.Aa,this));this.a().addEventListener(Ja,r(this.Ta,this));this.a().addEventListener(Ka,r(this.Ha,this));this.a().addEventListener(La,r(this.Oa,this))};f.Ta=function(a){A.log("Entity Updated:"+JSON.stringify(a));Ma(this,a.id,N(this,a.comp))};
f.Ha=function(a){A.log("Add component: "+JSON.stringify(a));Ma(this,a.id,N(this,a.comp));A.log(N(this,a.comp))};f.Oa=function(a){A.log("Remove component: "+JSON.stringify(a));var b=a.id;a=a.compName;if(z(this.f.b,a)){var c=this.f.get(a);a=this.l[c-1].get(b);this.l[c-1].remove(b)&&("string"==typeof c&&(c=this.f.get(c)),this.D.clear(this.I[b],c),a.$=null,this.a().fireEvent(Na,b))}};
function Ma(a,b,c){var d;if(z(a.f.b,c.name))d=a.f.get(c.name);else{d=c.name;var e=a.l.push(new y);a.f.set(d,e);d=e}a.l[d-1].set(b,c);"string"==typeof d&&(d=a.f.get(d));a.D.set(a.I[b],d);c.$=b;a.a().fireEvent(Na,b)}f.aa=function(a,b){return z(this.f.b,b)?this.ba(b).get(a):null};f.ba=function(a){z(this.f.b,a)?(a=this.f.get(a),a=this.l[a-1]):a=null;return a};f.Da=function(a){this.I[a]=[]};f.Ea=function(a){this.T.add(a)};f.Aa=function(a){Oa(this.a(),Ja,{id:a.$,comp:Pa(this,this.aa(a.$,a.Ya))})};
function Pa(a,b){var c={},d;c.__functions={};x(Object.getOwnPropertyNames(b),function(a){d=b[a];p(d)?(d=d.toString(),c.__functions[a]=d):c[a]=d});b.__proto__.__proto__&&(c.__prototype=Pa(a,b.__proto__));return c}function N(a,b){var c;b.__prototype?(c=Object.create(N(a,b.__prototype)),delete b.__prototype):c={};ea(b,function(a,b){"__functions"==b?ea(a,function(a,b){c[b]=eval("var fun = "+a+"; fun;")}):c[b]=a});return c}
function Qa(a){qa(a.T,r(function(a){for(var c=this.D.length(this.I[a]),d=0;d<c;d++)this.D.get(d)&&(this.l[d-1].remove(a),this.D.clear(d))},a));a.T.clear()};function Ra(){D.call(this);this.W=new K(this);this.ka=new J(this);this.v=new M(this);this.K=null;this.addEventListener(G,r(A.P,A));this.addEventListener(H,r(A.pause,A));this.addEventListener(Sa,r(function(){Oa(this,G)},this));this.addEventListener(Ta,r(function(){Oa(this,H)},this));this.addEventListener(Ua,r(this.Qa,this))}v(Ra,D);f=Ra.prototype;f.d=function(){this.log("Activating "+this.name,Va);this.ka.d();this.v.d();this.W.d()};
f.h=function(){console.log("Deactivating ",this.name);this.ka.h();this.v.h();this.W.h()};f.r=function(a){this.W.r(a);Qa(this.v)};f.aa=function(a,b){return this.v.aa(a,b)};f.ba=function(a){return this.v.ba(a)};f.Qa=function(a){null!=this.K?this.K.j(a.oa,a.data):A.J&&A.fa.j(a.oa,a.data)};function Oa(a,b,c){a.fireEvent(Ua,{oa:b,data:c})}f.log=function(a,b){A.log(a,b)};function O(){Ra.call(this)}v(O,Ra);O.prototype.name="ExampleScene";O.prototype.d=function(a){O.u.d.call(this,a);A.J||(this.K=new va("/jsc/sim.js"),this.fireEvent(Wa),A.A&&this.K.P())};O.prototype.h=function(){O.u.h.call(this)};function Xa(){0!=Ya&&(this[q]||(this[q]=++ba))}var Ya=0;var Za="closure_listenable_"+(1E6*Math.random()|0);function $a(a){try{return!(!a||!a[Za])}catch(b){return!1}}var ab=0;function bb(a,b,c,d,e){this.k=a;this.O=null;this.src=b;this.type=c;this.capture=!!d;this.M=e;this.key=++ab;this.t=this.L=!1}function cb(a){a.t=!0;a.k=null;a.O=null;a.src=null;a.M=null};function P(a){this.src=a;this.e={};this.Q=0}P.prototype.add=function(a,b,c,d,e){var g=this.e[a];g||(g=this.e[a]=[],this.Q++);var k=db(g,b,d,e);-1<k?(a=g[k],c||(a.L=!1)):(a=new bb(b,this.src,a,!!d,e),a.L=c,g.push(a));return a};P.prototype.remove=function(a,b,c,d){if(!(a in this.e))return!1;var e=this.e[a];b=db(e,b,c,d);return-1<b?(cb(e[b]),w.splice.call(e,b,1),0==e.length&&(delete this.e[a],this.Q--),!0):!1};
function eb(a,b){var c=b.type;c in a.e&&la(a.e[c],b)&&(cb(b),0==a.e[c].length&&(delete a.e[c],a.Q--))}P.prototype.da=function(a,b,c,d){a=this.e[a];var e=-1;a&&(e=db(a,b,c,d));return-1<e?a[e]:null};function db(a,b,c,d){for(var e=0;e<a.length;++e){var g=a[e];if(!g.t&&g.k==b&&g.capture==!!c&&g.M==d)return e}return-1};var Q,fb,gb,hb;function ib(){return h.navigator?h.navigator.userAgent:null}hb=gb=fb=Q=!1;var R;if(R=ib()){var jb=h.navigator;Q=0==R.lastIndexOf("Opera",0);fb=!Q&&(-1!=R.indexOf("MSIE")||-1!=R.indexOf("Trident"));gb=!Q&&-1!=R.indexOf("WebKit");hb=!Q&&!gb&&!fb&&"Gecko"==jb.product}var kb=Q,S=fb,lb=hb,T=gb;function mb(){var a=h.document;return a?a.documentMode:void 0}var nb;
a:{var ob="",U;if(kb&&h.opera)var pb=h.opera.version,ob="function"==typeof pb?pb():pb;else if(lb?U=/rv\:([^\);]+)(\)|;)/:S?U=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:T&&(U=/WebKit\/(\S+)/),U)var qb=U.exec(ib()),ob=qb?qb[1]:"";if(S){var rb=mb();if(rb>parseFloat(ob)){nb=String(rb);break a}}nb=ob}var sb={};
function V(a){var b;if(!(b=sb[a])){b=0;for(var c=String(nb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),g=0;0==b&&g<e;g++){var k=c[g]||"",n=d[g]||"",ya=RegExp("(\\d*)(\\D*)","g"),Pb=RegExp("(\\d*)(\\D*)","g");do{var s=ya.exec(k)||["","",""],t=Pb.exec(n)||["","",""];if(0==s[0].length&&0==t[0].length)break;b=((0==s[1].length?0:parseInt(s[1],10))<(0==t[1].length?0:parseInt(t[1],10))?-1:(0==s[1].length?0:parseInt(s[1],
10))>(0==t[1].length?0:parseInt(t[1],10))?1:0)||((0==s[2].length)<(0==t[2].length)?-1:(0==s[2].length)>(0==t[2].length)?1:0)||(s[2]<t[2]?-1:s[2]>t[2]?1:0)}while(0==b)}b=sb[a]=0<=b}return b}var tb=h.document,ub=tb&&S?mb()||("CSS1Compat"==tb.compatMode?parseInt(nb,10):5):void 0;var vb;(vb=!S)||(vb=S&&9<=ub);var wb=vb,xb=S&&!V("9");!T||V("528");lb&&V("1.9b")||S&&V("8")||kb&&V("9.5")||T&&V("528");lb&&!V("8")||S&&V("9");function W(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=this.s=!1;this.ua=!0}W.prototype.preventDefault=function(){this.defaultPrevented=!0;this.ua=!1};function yb(a){yb[" "](a);return a}yb[" "]=function(){};function X(a,b){W.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.charCode=this.keyCode=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pa=this.state=null;if(a){var c=this.type=a.type;this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(lb){var e;a:{try{yb(d.nodeName);e=!0;break a}catch(g){}e=!1}e||(d=null)}}else"mouseover"==c?
d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=T||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=T||void 0!==a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=
a.metaKey;this.state=a.state;this.pa=a;a.defaultPrevented&&this.preventDefault()}}v(X,W);X.prototype.preventDefault=function(){X.u.preventDefault.call(this);var a=this.pa;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,xb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var zb="closure_lm_"+(1E6*Math.random()|0),Y={},Ab=0;function Bb(a,b,c,d,e){if("array"==l(b))for(var g=0;g<b.length;g++)Bb(a,b[g],c,d,e);else if(c=Cb(c),$a(a))a.p.add(String(b),c,!1,d,e);else{if(!b)throw Error("Invalid event type");var g=!!d,k=Db(a);k||(a[zb]=k=new P(a));c=k.add(b,c,!1,d,e);c.O||(d=Eb(),c.O=d,d.src=a,d.k=c,a.addEventListener?a.addEventListener(b,d,g):a.attachEvent(b in Y?Y[b]:Y[b]="on"+b,d),Ab++)}}
function Eb(){var a=Fb,b=wb?function(c){return a.call(b.src,b.k,c)}:function(c){c=a.call(b.src,b.k,c);if(!c)return c};return b}function Gb(a,b,c,d,e){if("array"==l(b))for(var g=0;g<b.length;g++)Gb(a,b[g],c,d,e);else c=Cb(c),$a(a)?a.p.remove(String(b),c,d,e):a&&(a=Db(a))&&(b=a.da(b,c,!!d,e))&&Hb(b)}
function Hb(a){if("number"!=typeof a&&a&&!a.t){var b=a.src;if($a(b))eb(b.p,a);else{var c=a.type,d=a.O;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent&&b.detachEvent(c in Y?Y[c]:Y[c]="on"+c,d);Ab--;(c=Db(b))?(eb(c,a),0==c.Q&&(c.src=null,b[zb]=null)):cb(a)}}}function Ib(a,b,c,d){var e=1;if(a=Db(a))if(b=a.e[b])for(b=ma(b),a=0;a<b.length;a++){var g=b[a];g&&g.capture==c&&!g.t&&(e&=!1!==Jb(g,d))}return Boolean(e)}
function Jb(a,b){var c=a.k,d=a.M||a.src;a.L&&Hb(a);return c.call(d,b)}
function Fb(a,b){if(a.t)return!0;if(!wb){var c;if(!(c=b))a:{c=["window","event"];for(var d=h,e;e=c.shift();)if(null!=d[e])d=d[e];else{c=null;break a}c=d}e=c;c=new X(e,this);d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){a:{var g=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(k){g=!0}if(g||void 0==e.returnValue)e.returnValue=!0}e=[];for(g=c.currentTarget;g;g=g.parentNode)e.push(g);for(var g=a.type,n=e.length-1;!c.s&&0<=n;n--)c.currentTarget=e[n],d&=Ib(e[n],g,!0,c);for(n=0;!c.s&&n<e.length;n++)c.currentTarget=
e[n],d&=Ib(e[n],g,!1,c)}return d}return Jb(a,new X(b,this))}function Db(a){a=a[zb];return a instanceof P?a:null}var Kb="__closure_events_fn_"+(1E9*Math.random()>>>0);function Cb(a){return p(a)?a:a[Kb]||(a[Kb]=function(b){return a.handleEvent(b)})};function Z(){Xa.call(this);this.p=new P(this);this.ya=this}v(Z,Xa);Z.prototype[Za]=!0;f=Z.prototype;f.ta=null;f.addEventListener=function(a,b,c,d){Bb(this,a,b,c,d)};f.removeEventListener=function(a,b,c,d){Gb(this,a,b,c,d)};
f.dispatchEvent=function(a){var b,c=this.ta;if(c)for(b=[];c;c=c.ta)b.push(c);var c=this.ya,d=a.type||a;if(m(a))a=new W(a,c);else if(a instanceof W)a.target=a.target||c;else{var e=a;a=new W(d,c);ia(a,e)}var e=!0,g;if(b)for(var k=b.length-1;!a.s&&0<=k;k--)g=a.currentTarget=b[k],e=Lb(g,d,!0,a)&&e;a.s||(g=a.currentTarget=c,e=Lb(g,d,!0,a)&&e,a.s||(e=Lb(g,d,!1,a)&&e));if(b)for(k=0;!a.s&&k<b.length;k++)g=a.currentTarget=b[k],e=Lb(g,d,!1,a)&&e;return e};
function Lb(a,b,c,d){b=a.p.e[String(b)];if(!b)return!0;b=ma(b);for(var e=!0,g=0;g<b.length;++g){var k=b[g];if(k&&!k.t&&k.capture==c){var n=k.k,ya=k.M||k.src;k.L&&eb(a.p,k);e=!1!==n.call(ya,d)&&e}}return e&&!1!=d.ua}f.da=function(a,b,c,d){return this.p.da(String(a),b,c,d)};function Mb(a,b){Z.call(this);this.N=a||1;this.F=b||h;this.Z=r(this.Va,this);this.ea=u()}v(Mb,Z);f=Mb.prototype;f.enabled=!1;f.g=null;f.Va=function(){if(this.enabled){var a=u()-this.ea;0<a&&a<0.8*this.N?this.g=this.F.setTimeout(this.Z,this.N-a):(this.g&&(this.F.clearTimeout(this.g),this.g=null),this.dispatchEvent(Nb),this.enabled&&(this.g=this.F.setTimeout(this.Z,this.N),this.ea=u()))}};f.start=function(){this.enabled=!0;this.g||(this.g=this.F.setTimeout(this.Z,this.N),this.ea=u())};
f.stop=function(){this.enabled=!1;this.g&&(this.F.clearTimeout(this.g),this.g=null)};var Nb="tick";function Ob(){this.na=new y;this.ja=null;return this}f=Ob.prototype;f.r=function(a){null!=this.i()&&this.i().r(a)};f.Y=function(a){this.na.set(a.name,a);null==this.i()&&this.ha(a.name);return!0};f.a=function(a){return this.na.get(a)};f.i=function(){return this.ja};f.ha=function(a,b){var c=this.a(a),d=this.i();return void 0!==c?(null!=d&&d.h(),this.ja=c,null!=this.i()&&this.i().d(b),!0):!1};f.fireEvent=function(a,b){var c=this.i();null!=c&&c.fireEvent(a,b)};function Qb(a,b){this.id=a;this.startTime=b;this.Ca=null};function Rb(){this.ra=1;this.frame=null};function Sb(){F.call(this,new C)}v(Sb,F);var Tb=["CrunchJS","DATA_SYNC_DEBUG"],$=h;Tb[0]in $||!$.execScript||$.execScript("var "+Tb[0]);for(var Ub;Tb.length&&(Ub=Tb.shift());)$=$[Ub]?$[Ub]:$[Ub]={};
var Sa="engine_started",Ta="engine_paused",Ga="entity_created",Ca="entity_destroyed",Da="entity_enabled",Ea="entity_disabled",Na="entity_changed",Ia="component_changed",Wa="sim_added",Ua="send_command",G="run",H="pause",ua="write",wa="create_entity",xa="destroy_entity",Ja="update_component",Ka="add_component",La="remove_component",za="enable_entity",Aa="disable_entity",sa="sync_request",ta="sync",Va="DEBUG: ";
function Vb(a){A={};A=this;this.G=null;this.J=this.ma="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;this.A=!1;this.n=new Ob;this.la=new Rb;this.fa=null;void 0==a&&(a={});ea({Fa:60},function(b,c){c in a||(a[c]=b)});this.G=new Mb(1E3/a.Fa);Bb(this.G,Nb,r(this.step,this));this.J&&this.ma&&(this.fa=new Sb);return this}f=Vb.prototype;f.P=function(){this.A=!0;this.G.start();this.fireEvent(Sa);this.log("Engine Running")};
f.pause=function(){this.A=!1;this.G.stop();this.fireEvent(Ta);this.log("Engine Paused")};f.step=function(){var a=this.la,b=u();a.frame=new Qb(a.ra,b);a.ra++;this.n.r(a.frame);a=this.la;b=u();a.frame.Ca=b};f.Y=function(a){return this.n.Y(a)};f.a=function(a){return this.n.a(a)};f.ha=function(a,b){var c=this.n.ha(a,b);this.Za();return c};f.i=function(){return this.n.i()};f.fireEvent=function(a,b){this.n.fireEvent(a,b)};f.log=function(a,b){b||(b=Va);this.write({prefix:b,message:a})};
f.write=function(a){this.J?(a.prefix="WW - "+a.prefix,a.message=a.message,this.fa.write(a)):console.log(a.prefix,a.message)};new function(){var a=new Vb;A.log("I'M ALIVE",Va);var b=new O;a.Y(b)};
